---
layout: article
title:  "spark在数据仓库构建中的应用以及重点事项"
categories: other
toc: false
ads: true
image:
    teaser: /teaser/dw.jpg
---

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgheadline22">1. 数据仓库建设</a>
<ul>
<li><a href="#orgheadline5">1.1. 如何解决多数据源（不同客户）的问题？</a>
<ul>
<li><a href="#orgheadline1">1.1.1. 问题1：customer可能会有不同类型的数据源：</a></li>
<li><a href="#orgheadline2">1.1.2. 问题2：多数据集之间需要join</a></li>
<li><a href="#orgheadline3">1.1.3. 传统解决办法：</a></li>
<li><a href="#orgheadline4">1.1.4. 传统方法面临的问题：</a></li>
</ul>
</li>
<li><a href="#orgheadline9">1.2. Spark解决方案</a>
<ul>
<li><a href="#orgheadline6">1.2.1. 从数据源上解耦合</a></li>
<li><a href="#orgheadline7">1.2.2. 直接从数据源直接读</a></li>
<li><a href="#orgheadline8">1.2.3. scheme在读的时候定义</a></li>
</ul>
</li>
<li><a href="#orgheadline13">1.3. 在数据整合完了之后的数据转换</a>
<ul>
<li><a href="#orgheadline10">1.3.1. 调度生产任务工作流用notebooks或者jars包来完成</a></li>
<li><a href="#orgheadline11">1.3.2. 创建pipelines</a></li>
<li><a href="#orgheadline12">1.3.3. 监控结果</a></li>
</ul>
</li>
<li><a href="#orgheadline14">1.4. 性能优化</a></li>
<li><a href="#orgheadline16">1.5. 可视化</a>
<ul>
<li><a href="#orgheadline15">1.5.1. notebooks</a></li>
</ul>
</li>
<li><a href="#orgheadline21">1.6. 安装管理</a>
<ul>
<li><a href="#orgheadline17">1.6.1. 加密</a></li>
<li><a href="#orgheadline18">1.6.2. 用户管理</a></li>
<li><a href="#orgheadline19">1.6.3. notebooks 读写操作管理</a></li>
<li><a href="#orgheadline20">1.6.4. admin users</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

# 数据仓库建设<a id="orgheadline22"></a>

## 如何解决多数据源（不同客户）的问题？<a id="orgheadline5"></a>

### 问题1：customer可能会有不同类型的数据源：<a id="orgheadline1"></a>

-   云存储：亚马逊:s3
-   数据库：MySql，NoSQL
-   APIs: Facebook, SalesForce and etc

### 问题2：多数据集之间需要join<a id="orgheadline2"></a>

### 传统解决办法：<a id="orgheadline3"></a>

-   数据复制到数据仓库
-   在复制之前需要提前创建好schema

### 传统方法面临的问题：<a id="orgheadline4"></a>

-   数据移动：成本太高、耗时；原来数据跟新时会造成不一致
-   需要提前定义主题：不同的需求下面很难去改动schema

## Spark解决方案<a id="orgheadline9"></a>

### 从数据源上解耦合<a id="orgheadline6"></a>

-   利用亚马逊S3 和 非HDFS形式

### 直接从数据源直接读<a id="orgheadline7"></a>

-   消除数据复制的需求

### scheme在读的时候定义<a id="orgheadline8"></a>

-   sparksql

## 在数据整合完了之后的数据转换<a id="orgheadline13"></a>

### 调度生产任务工作流用notebooks或者jars包来完成<a id="orgheadline10"></a>

### 创建pipelines<a id="orgheadline11"></a>

### 监控结果<a id="orgheadline12"></a>

## 性能优化<a id="orgheadline14"></a>

-   用parquet格式存储数据
-   数据集分区
-   spark caching （jvm、ssd）
-   以parquet格式存储聚合数据

## 可视化<a id="orgheadline16"></a>

### notebooks<a id="orgheadline15"></a>

-   内建画图功能
-   r语言的画图工具ggplot以及python的画图包matplotlib
-   d3 可视化

## 安装管理<a id="orgheadline21"></a>

### 加密<a id="orgheadline17"></a>

-   ssl
-   s3 encryption

### 用户管理<a id="orgheadline18"></a>

ACLs

### notebooks 读写操作管理<a id="orgheadline19"></a>

### admin users<a id="orgheadline20"></a>
